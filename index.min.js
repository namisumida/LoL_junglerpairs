function init(){function resize(){w_svg=document.getElementById("graphic-svg").getBoundingClientRect().width,graphicMargin={w:w_svg-margin.left-margin.right,w_names:90,btwn_names:15,h_col:13,h_btwn:5},w_dotLine=graphicMargin.w-graphicMargin.w_names-graphicMargin.btwn_names,xScale_win=d3.scaleLinear().domain([0,1]).range([80,w_dotLine]),xScale_play=d3.scaleLinear().domain([0,d3.max(champ_subset,function(d){return d.n_games})]).range([0,d3.min([xScale_win(currAvg),w_dotLine-xScale_win(currAvg)])]),function(){dotGroup.select("#dotBackground").attr("x",graphicMargin.w_names).attr("y",function(d,i){return(graphicMargin.h_col+graphicMargin.h_btwn)*i}).attr("width",w_dotLine+graphicMargin.btwn_names+margin.right).attr("height",graphicMargin.h_col),dotGroup.select(".pairBar").attr("width",function(d){return xScale_play(d.n_games)}).attr("height",graphicMargin.h_col).attr("x",graphicMargin.w_names+graphicMargin.btwn_names).attr("y",function(d,i){return(graphicMargin.h_col+graphicMargin.h_btwn)*i}),nameGroup.select("#nameBackground").attr("y",function(d,i){return(graphicMargin.h_col+graphicMargin.h_btwn)*i}).attr("width",graphicMargin.w_names).attr("height",graphicMargin.h_col),nameGroup.select(".pairNameText").attr("x",graphicMargin.w_names).attr("y",function(d,i){return(graphicMargin.h_col+graphicMargin.h_btwn)*i+graphicMargin.h_col/2+3}),dotGroup.select(".dotDistance").attr("x",function(d){var winRate=+d.winrate.toFixed(2);return winRate>currAvg?graphicMargin.w_names+graphicMargin.btwn_names+xScale_win(currAvg):graphicMargin.w_names+graphicMargin.btwn_names+xScale_win(+winRate.toFixed(2))}).attr("y",function(d,i){return(graphicMargin.h_col+graphicMargin.h_btwn)*i+graphicMargin.h_col/2-1}).attr("width",function(d){return Math.abs(xScale_win(+d.winrate.toFixed(2))-xScale_win(currAvg))}),dotGroup.select(".avgDot").attr("cx",function(d){return graphicMargin.w_names+graphicMargin.btwn_names+xScale_win(currAvg)}).attr("cy",function(d,i){return(graphicMargin.h_col+graphicMargin.h_btwn)*i+graphicMargin.h_col/2}),dotGroup.select(".pairDot").attr("cx",function(d){return graphicMargin.w_names+graphicMargin.btwn_names+xScale_win(+d.winrate.toFixed(2))}).attr("cy",function(d,i){return(graphicMargin.h_col+graphicMargin.h_btwn)*i+graphicMargin.h_col/2}),dotGroup.select("#gamesCountLabel").attr("x",graphicMargin.w_names+graphicMargin.btwn_names+5).attr("y",function(d,i){return(graphicMargin.h_col+graphicMargin.h_btwn)*i+graphicMargin.h_col/2+4}),dotGroup.select("#avgCountLabel").attr("x",function(d){return+d.winrate.toFixed(2)>currAvg?graphicMargin.w_names+graphicMargin.btwn_names+xScale_win(currAvg)-8:graphicMargin.w_names+graphicMargin.btwn_names+xScale_win(currAvg)+8}).attr("y",function(d,i){return(graphicMargin.h_col+graphicMargin.h_btwn)*i+graphicMargin.h_col/2+4}),dotGroup.select("#pairCountLabel").attr("x",function(d){var roundedAvg=+d.winrate.toFixed(2);return roundedAvg>currAvg?graphicMargin.w_names+graphicMargin.btwn_names+xScale_win(roundedAvg)+8:graphicMargin.w_names+graphicMargin.btwn_names+xScale_win(roundedAvg)-8}).attr("y",function(d,i){return(graphicMargin.h_col+graphicMargin.h_btwn)*i+graphicMargin.h_col/2+4}),svg.selectAll(".midline").attr("x1",graphicMargin.w_names+graphicMargin.btwn_names+xScale_win(currAvg)).attr("x2",graphicMargin.w_names+graphicMargin.btwn_names+xScale_win(currAvg)).attr("y2",margin.top+(graphicMargin.h_col+graphicMargin.h_btwn)*(nPairs-1)+graphicMargin.h_col/2);var firstRow=champ_subset[0],firstRowDist=xScale_win(+firstRow.winrate.toFixed(2))-xScale_win(currAvg);svg.select("#avgDataLabel").text(currChampionName+"'s win rate").attr("x",function(){return Math.abs(firstRowDist)<30?firstRowDist<0?graphicMargin.w_names+graphicMargin.btwn_names+xScale_win(currAvg)+5:graphicMargin.w_names+graphicMargin.btwn_names+xScale_win(currAvg)-5:graphicMargin.w_names+graphicMargin.btwn_names+xScale_win(currAvg)}).call(wrapChampion).style("text-anchor",function(){return Math.abs(firstRowDist)<60?firstRowDist<0?"start":"end":"middle"}),svg.select("#pairDataLabel").text("Paired win rate").attr("x",function(){return Math.abs(firstRowDist)<30?firstRowDist<0?graphicMargin.w_names+graphicMargin.btwn_names+xScale_win(+champ_subset[0].winrate.toFixed(2))-5:graphicMargin.w_names+graphicMargin.btwn_names+xScale_win(+champ_subset[0].winrate.toFixed(2))+5:graphicMargin.w_names+graphicMargin.btwn_names+xScale_win(+champ_subset[0].winrate.toFixed(2))}).call(wrap,50).style("text-anchor",function(){return Math.abs(firstRowDist)<60?firstRowDist<0?"end":"start":"middle"}),svg.selectAll(".breakline").attr("x2",w_svg).attr("y1",function(d,i){return margin.top+(graphicMargin.h_col+graphicMargin.h_btwn)*i*5-graphicMargin.h_btwn/2}).attr("y2",function(d,i){return margin.top+(graphicMargin.h_col+graphicMargin.h_btwn)*i*5-graphicMargin.h_btwn/2}),updateClick()}()}function wrap(text,width){text.each(function(){for(var word,text=d3.select(this),words=text.text().split(/\s+/).reverse(),line=[],lineNumber=0,x=text.attr("x"),y=text.attr("y"),tspan=text.text(null).append("tspan").attr("x",x).attr("y",y).attr("dy","0em");word=words.pop();)line.push(word),tspan.text(line.join(" ")),tspan.node().getComputedTextLength()>width&&(line.pop(),tspan.text(line.join(" ")),line=[word],tspan=text.append("tspan").attr("x",x).attr("y",y).attr("dy",1.3*++lineNumber+0+"em").text(word))})}function wrapChampion(text){text.each(function(){var word,text=d3.select(this),words=text.text().split(/\s+/).reverse(),line=[],lineNumber=0,x=text.attr("x"),y=text.attr("y"),tspan=text.text(null).append("tspan").attr("x",x).attr("y",y).attr("dy","0em"),champNameLength=tspan.text(currChampionName+"'s").node().getComputedTextLength();if(champNameLength<45)var width=45;else width=champNameLength;for(;word=words.pop();)line.push(word),tspan.text(line.join(" ")),tspan.node().getComputedTextLength()>width&&(line.pop(),tspan.text(line.join(" ")),line=[word],tspan=text.append("tspan").attr("x",x).attr("y",y).attr("dy",1.3*++lineNumber+0+"em").text(word))})}function updateChampion(champ){currChampionName=champ.replace("+ ","");var subset,maxDistance,avgDataRow=avg_data.filter(function(d){return d.champ==currChampionName})[0];currAvg=+avgDataRow.winrate.toFixed(2),function(){var slider=d3.select(".slider"),previousValue=parseInt(slider.node().value),subset=dataset.filter(function(d){return d.champ1==currChampionName}),subset_max=d3.max(subset,function(d){return d.n_games});document.getElementById("slider").min=d3.min(subset,function(d){return d.n_games}),document.getElementById("slider").max=subset_max;var newMin=document.getElementById("slider").min;previousValue<newMin&&(document.getElementById("slider-instructions").innerHTML="Show pairs with at least "+newMin+" games played:")}(),champ_subset=dataset.filter(function(d){return d.champ1==currChampionName}),subset=champ_subset,maxDistance=d3.min([xScale_win(currAvg),w_dotLine-xScale_win(currAvg)]),xScale_play=d3.scaleLinear().domain([0,d3.max(subset,function(d){return d.n_games})]).range([0,maxDistance]),document.getElementById("champion-name").innerHTML=currChampionName;var iconURLname=currChampionName.replace("'","");iconURLname=(iconURLname=iconURLname.replace(".","")).replace(" ",""),document.getElementById("champion-icon").src="icons/"+iconURLname+".png"}function updateData(){champ_subset=dataset.filter(function(d){return d.champ1==currChampionName&d.n_games>=sliderValue}),"win"==sort?champ_subset.sort(function(a,b){return d3.descending(a.winrate,b.winrate)}):"alpha"==sort?champ_subset.sort(function(a,b){return d3.ascending(a.champ2,b.champ2)}):champ_subset.sort(function(a,b){return d3.descending(a.n_games,b.n_games)}),nPairs=champ_subset.length}function updateClick(){dotGroup.on("mouseover",function(d){var currElement=d3.select(this),currPair=d.champ2;currElement.selectAll(".countLabel").style("fill","black"),currElement.select(".pairBar").style("fill",dotColor).style("opacity",.5),currElement.select(".dotDistance").style("opacity",1),d3.selectAll(".pairNameText").filter(function(d){return d.champ2==currPair}).style("font-family","radnika-bold")}).on("mouseout",function(d){var currElement=d3.select(this);currElement.selectAll(".countLabel").style("fill","none"),currElement.select(".pairBar").style("fill",light_gray).style("opacity",.3),currElement.select(".dotDistance").style("opacity",.5),svg.selectAll(".pairNameText").style("font-family","radnika-regular")}),nameGroup.on("click",function(d){updateChampion(d3.select(this)._groups[0][0].textContent),updateData(),updateGraphic()}).on("mouseover",function(d){d3.select(this).select(".pairNameText").style("font-family","radnika-bold");var currPair=d.champ2,currDotGroup=svg.selectAll(".dotGroup").filter(function(d){return d.champ2==currPair});currDotGroup.selectAll(".countLabel").style("fill","black"),currDotGroup.select(".pairBar").style("fill",dotColor).style("opacity",.5),currDotGroup.select(".dotDistance").style("opacity",1)}).on("mouseout",function(d){d3.select(this).select(".pairNameText").style("font-family","radnika-regular");var currPair=d.champ2,currDotGroup=svg.selectAll(".dotGroup").filter(function(d){return d.champ2==currPair});currDotGroup.selectAll(".countLabel").style("fill","none"),currDotGroup.select(".pairBar").style("fill",light_gray).style("opacity",.3),currDotGroup.select(".dotDistance").style("opacity",.5)})}function updateSizing(){var currentHeight=margin.top+(graphicMargin.h_col+graphicMargin.h_btwn)*nPairs;document.getElementById("graphic-svg").style.height=currentHeight+30+"px"}function updateButton(button){var value=button._groups[0][0].value;button.style("background-color",d3.rgb(79,39,79)).style("color","white"),"win"==value?(d3.select("#button-alpha").style("background-color","white").style("color",d3.rgb(79,39,79)),d3.select("#button-play").style("background-color","white").style("color",d3.rgb(79,39,79))):"play"==value?(d3.select("#button-alpha").style("background-color","white").style("color",d3.rgb(79,39,79)),d3.select("#button-win").style("background-color","white").style("color",d3.rgb(79,39,79))):"alpha"==value&&(d3.select("#button-win").style("background-color","white").style("color",d3.rgb(79,39,79)),d3.select("#button-play").style("background-color","white").style("color",d3.rgb(79,39,79)))}function updateGraphic(){pairGroup=svg.selectAll(".pairGroup").data(champ_subset),dotGroup=pairGroup.select(".dotGroup"),nameGroup=pairGroup.select(".nameGroup"),dotGroup.exit().remove(),nameGroup.exit().remove(),pairGroup.exit().remove(),pairGroupEnter=pairGroup.enter().append("g").attr("class","pairGroup").attr("transform","translate(0,"+margin.top+")"),dotGroupEnter=pairGroupEnter.append("g").attr("class","dotGroup"),nameGroupEnter=pairGroupEnter.append("g").attr("class","nameGroup"),dotGroupEnter.append("rect").attr("class","background").attr("id","dotBackground").attr("x",graphicMargin.w_names).attr("y",function(d,i){return(graphicMargin.h_col+graphicMargin.h_btwn)*i}).attr("width",w_dotLine+graphicMargin.btwn_names+margin.right).attr("height",graphicMargin.h_col),dotGroupEnter.append("rect").attr("class","pairBar").attr("width",function(d){return xScale_play(d.n_games)}).attr("height",graphicMargin.h_col).attr("x",graphicMargin.w_names+graphicMargin.btwn_names).attr("y",function(d,i){return(graphicMargin.h_col+graphicMargin.h_btwn)*i}).style("fill",light_gray).style("opacity",.3),nameGroupEnter.append("rect").attr("class","background").attr("id","nameBackground").attr("x",0).attr("y",function(d,i){return(graphicMargin.h_col+graphicMargin.h_btwn)*i}).attr("width",graphicMargin.w_names).attr("height",graphicMargin.h_col),nameGroupEnter.append("text").attr("class","pairNameText").text(function(d){return"+ "+d.champ2}).attr("x",graphicMargin.w_names).attr("y",function(d,i){return(graphicMargin.h_col+graphicMargin.h_btwn)*i+graphicMargin.h_col/2+3}),dotGroupEnter.append("rect").attr("class","dotDistance").attr("x",function(d){var winRate=+d.winrate.toFixed(2);return winRate>currAvg?graphicMargin.w_names+graphicMargin.btwn_names+xScale_win(currAvg):graphicMargin.w_names+graphicMargin.btwn_names+xScale_win(+winRate.toFixed(2))}).attr("y",function(d,i){return(graphicMargin.h_col+graphicMargin.h_btwn)*i+graphicMargin.h_col/2-1}).attr("height",2).attr("width",function(d){return Math.abs(xScale_win(+d.winrate.toFixed(2))-xScale_win(currAvg))}),dotGroupEnter.append("circle").attr("class","avgDot").attr("cx",function(d){return graphicMargin.w_names+graphicMargin.btwn_names+xScale_win(currAvg)}).attr("cy",function(d,i){return(graphicMargin.h_col+graphicMargin.h_btwn)*i+graphicMargin.h_col/2}).attr("r",4).style("fill",highlightColor),dotGroupEnter.append("circle").attr("class","pairDot").attr("cx",function(d){return graphicMargin.w_names+graphicMargin.btwn_names+xScale_win(+d.winrate.toFixed(2))}).attr("cy",function(d,i){return(graphicMargin.h_col+graphicMargin.h_btwn)*i+graphicMargin.h_col/2}).attr("r",4).style("fill",function(d){var roundedWin=+d.winrate.toFixed(2);return roundedWin>currAvg?green:roundedWin<currAvg?red:dark_gray}),dotGroupEnter.append("text").attr("class","countLabel").attr("id","gamesCountLabel").attr("x",graphicMargin.w_names+graphicMargin.btwn_names+5).attr("y",function(d,i){return(graphicMargin.h_col+graphicMargin.h_btwn)*i+graphicMargin.h_col/2+4}).text(function(d){return d3.format(",")(d.n_games)}).style("text-anchor","start").style("fill","none"),dotGroupEnter.append("text").attr("class","countLabel").attr("id","avgCountLabel").attr("x",function(d){return+d.winrate.toFixed(2)>currAvg?graphicMargin.w_names+graphicMargin.btwn_names+xScale_win(currAvg)-8:graphicMargin.w_names+graphicMargin.btwn_names+xScale_win(currAvg)+8}).attr("y",function(d,i){return(graphicMargin.h_col+graphicMargin.h_btwn)*i+graphicMargin.h_col/2+4}).text(function(d){return d3.format(".0%")(currAvg)}).style("text-anchor",function(d){return+d.winrate.toFixed(2)>currAvg?"end":"start"}).style("fill","none"),dotGroupEnter.append("text").attr("class","countLabel").attr("id","pairCountLabel").attr("x",function(d){var roundedAvg=+d.winrate.toFixed(2);return roundedAvg>currAvg?graphicMargin.w_names+graphicMargin.btwn_names+xScale_win(roundedAvg)+8:graphicMargin.w_names+graphicMargin.btwn_names+xScale_win(roundedAvg)-8}).attr("y",function(d,i){return(graphicMargin.h_col+graphicMargin.h_btwn)*i+graphicMargin.h_col/2+4}).text(function(d){if(+d.winrate.toFixed(2)!=currAvg)return d3.format(".0%")(d.winrate)}).style("text-anchor",function(d){return+d.winrate.toFixed(2)>currAvg?"start":"end"}).style("fill","none"),dotGroup=dotGroup.merge(dotGroupEnter),nameGroup=nameGroup.merge(nameGroupEnter),pairGroup=pairGroup.merge(pairGroupEnter),svg.selectAll(".midline").attr("x1",graphicMargin.w_names+graphicMargin.btwn_names+xScale_win(currAvg)).attr("x2",graphicMargin.w_names+graphicMargin.btwn_names+xScale_win(currAvg)).attr("y2",margin.top+(graphicMargin.h_col+graphicMargin.h_btwn)*(nPairs-1)+graphicMargin.h_col/2),dotGroup.select("#dotBackground").attr("y",function(d,i){return(graphicMargin.h_col+graphicMargin.h_btwn)*i}),dotGroup.select(".pairBar").attr("width",function(d){return xScale_play(d.n_games)}).attr("x",graphicMargin.w_names+graphicMargin.btwn_names).attr("y",function(d,i){return(graphicMargin.h_col+graphicMargin.h_btwn)*i}).style("fill",light_gray).style("opacity",.3),nameGroup.select("#nameBackground").attr("y",function(d,i){return(graphicMargin.h_col+graphicMargin.h_btwn)*i}),nameGroup.select(".pairNameText").text(function(d){return"+ "+d.champ2}).attr("y",function(d,i){return(graphicMargin.h_col+graphicMargin.h_btwn)*i+graphicMargin.h_col/2+3}).style("font-family","radnika-regular"),dotGroup.select(".dotDistance").attr("x",function(d){var winRate=+d.winrate.toFixed(2);return winRate>currAvg?graphicMargin.w_names+graphicMargin.btwn_names+xScale_win(currAvg):graphicMargin.w_names+graphicMargin.btwn_names+xScale_win(+winRate.toFixed(2))}).attr("y",function(d,i){return(graphicMargin.h_col+graphicMargin.h_btwn)*i+graphicMargin.h_col/2-1}).attr("width",function(d){return Math.abs(xScale_win(+d.winrate.toFixed(2))-xScale_win(currAvg))}).style("opacity",.5),dotGroup.select(".avgDot").attr("cx",function(d){return graphicMargin.w_names+graphicMargin.btwn_names+xScale_win(currAvg)}).attr("cy",function(d,i){return(graphicMargin.h_col+graphicMargin.h_btwn)*i+graphicMargin.h_col/2}),dotGroup.select(".pairDot").attr("cx",function(d){return graphicMargin.w_names+graphicMargin.btwn_names+xScale_win(+d.winrate.toFixed(2))}).attr("cy",function(d,i){return(graphicMargin.h_col+graphicMargin.h_btwn)*i+graphicMargin.h_col/2}).style("fill",function(d){var roundedWin=+d.winrate.toFixed(2);return roundedWin>currAvg?green:roundedWin<currAvg?red:dark_gray}),dotGroup.select("#gamesCountLabel").attr("x",graphicMargin.w_names+graphicMargin.btwn_names+5).attr("y",function(d,i){return(graphicMargin.h_col+graphicMargin.h_btwn)*i+graphicMargin.h_col/2+4}).text(function(d){return d3.format(",")(d.n_games)}).style("text-anchor","start").style("fill","none"),dotGroup.select("#avgCountLabel").attr("x",function(d){return+d.winrate.toFixed(2)>currAvg?graphicMargin.w_names+graphicMargin.btwn_names+xScale_win(currAvg)-8:graphicMargin.w_names+graphicMargin.btwn_names+xScale_win(currAvg)+8}).attr("y",function(d,i){return(graphicMargin.h_col+graphicMargin.h_btwn)*i+graphicMargin.h_col/2+4}).text(function(d){return d3.format(".0%")(currAvg)}).style("text-anchor",function(d){return+d.winrate.toFixed(2)>currAvg?"end":"start"}).style("fill","none"),dotGroup.select("#pairCountLabel").attr("x",function(d){var roundedAvg=+d.winrate.toFixed(2);return roundedAvg>currAvg?graphicMargin.w_names+graphicMargin.btwn_names+xScale_win(roundedAvg)+8:graphicMargin.w_names+graphicMargin.btwn_names+xScale_win(roundedAvg)-8}).attr("y",function(d,i){return(graphicMargin.h_col+graphicMargin.h_btwn)*i+graphicMargin.h_col/2+4}).text(function(d){if(+d.winrate.toFixed(2)!=currAvg)return d3.format(".0%")(d.winrate)}).style("text-anchor",function(d){return+d.winrate.toFixed(2)>currAvg?"start":"end"}).style("fill","none");var firstRow=champ_subset[0],firstRowDist=xScale_win(+firstRow.winrate.toFixed(2))-xScale_win(currAvg);svg.select("#avgDataLabel").text(currChampionName+"'s win rate").attr("x",function(){return Math.abs(firstRowDist)<30?firstRowDist<0?graphicMargin.w_names+graphicMargin.btwn_names+xScale_win(currAvg)+5:graphicMargin.w_names+graphicMargin.btwn_names+xScale_win(currAvg)-5:graphicMargin.w_names+graphicMargin.btwn_names+xScale_win(currAvg)}).attr("y",margin.top-25).call(wrapChampion).style("text-anchor",function(){return Math.abs(firstRowDist)<60?firstRowDist<0?"start":"end":"middle"}),svg.select("#pairDataLabel").text("Paired win rate").attr("x",function(){return Math.abs(firstRowDist)<30?firstRowDist<0?graphicMargin.w_names+graphicMargin.btwn_names+xScale_win(+champ_subset[0].winrate.toFixed(2))-5:graphicMargin.w_names+graphicMargin.btwn_names+xScale_win(+champ_subset[0].winrate.toFixed(2))+5:graphicMargin.w_names+graphicMargin.btwn_names+xScale_win(+champ_subset[0].winrate.toFixed(2))}).attr("y",margin.top-25).call(wrap,50).style("text-anchor",function(){return Math.abs(firstRowDist)<60?firstRowDist<0?"end":"start":"middle"}),svg.selectAll("breakline").data(champ_subset.filter(function(d,i){return(i+1)%5==0})).enter().append("line").attr("class","breakline").attr("x2",w_svg).attr("y1",function(d,i){return margin.top+(graphicMargin.h_col+graphicMargin.h_btwn)*i*5-graphicMargin.h_btwn/2}).attr("y2",function(d,i){return margin.top+(graphicMargin.h_col+graphicMargin.h_btwn)*i*5-graphicMargin.h_btwn/2}),updateClick(),updateSizing()}document.getElementById("js-junglerpairs").innerHTML='\n\t<section id="options">\n\t\t<div id="name-image-container">\n\t\t\t<div id="name-container">\n\t\t\t\t<h2 id="champion-name">Nunu</h2>\n\t\t\t</div>\n\t\t\t<img id="champion-icon" src="https://ddragon.leagueoflegends.com/cdn/8.23.1/img/champion/Aatrox.png" alt="Champion icon">\n\t\t</div>\n\t\t<div id="options-container">\n\t\t\t<div id="searchbar-container">\n\t\t\t\t<h5 id="searchbar-instructions">Search for champions:</h5>\n\t\t\t\t<input id="searchbar" type="text" placeholder="Type name">\n\t\t\t</div>\n\t\t\t<div id="button-section">\n\t\t\t\t<h5 id="button-instructions">Sort by:</h5>\n\t\t\t\t<div id="button-container">\n\t\t\t\t\t<button type="button" id="button-win" value="win">Win rate</button>\n\t\t\t\t\t<button type="button" id="button-play" value="play"># of games</button>\n\t\t\t\t\t<button type="button" id="button-alpha" value="alpha">Champion name</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div id="slider-container">\n\t\t\t\t<h5 id="slider-instructions">Show pairs with at least 200 games played:</h5>\n\t\t\t\t<input id="slider" class="slider" type="range" min="137" max="12567" step="1" value="200" orient="horizontal"></input>\n\t\t\t</div>\n\t\t</div>\n\t</section>\n\t<svg id="graphic-svg" height="100%" width="100%"></svg>\n  ';var xScale_play,svg=d3.select("#graphic-svg"),w_svg=document.getElementById("graphic-svg").getBoundingClientRect().width,margin={left:5,right:40,top:60,bottom:0},graphicMargin={w:w_svg-margin.left-margin.right,w_names:90,btwn_names:15,h_col:13,h_btwn:5},w_dotLine=graphicMargin.w-graphicMargin.w_names-graphicMargin.btwn_names,green="green",red=d3.rgb(212,89,84),gray=d3.color("#a19da8"),dark_gray=d3.rgb(100,100,100),dotColor=d3.color("#f6bba8"),highlightColor=d3.rgb(79,39,79),light_gray=d3.rgb(200,200,200),avg_data=[{champ:"Aatrox",winrate:.484620106433638},{champ:"Ahri",winrate:.498866213169796},{champ:"Akali",winrate:.397741472697074},{champ:"Alistar",winrate:.537150429510739},{champ:"Amumu",winrate:.553002044495287},{champ:"Anivia",winrate:.528135990590416},{champ:"Annie",winrate:.486048307080181},{champ:"Ashe",winrate:.463068849431503},{champ:"Aurelion Sol",winrate:.485882675446135},{champ:"Azir",winrate:.458300147994994},{champ:"Bard",winrate:.471827811586207},{champ:"Blitzcrank",winrate:.458426161687977},{champ:"Brand",winrate:.58729332118676},{champ:"Braum",winrate:.48779204375763},{champ:"Caitlyn",winrate:.467790612999271},{champ:"Camille",winrate:.475134020650502},{champ:"Cassiopeia",winrate:.534426789693149},{champ:"Cho'Gath",winrate:.5134551089114},{champ:"Corki",winrate:.472509702557568},{champ:"Darius",winrate:.498715124812913},{champ:"Diana",winrate:.523989185700549},{champ:"Dr. Mundo",winrate:.543204534644253},{champ:"Draven",winrate:.467213935332566},{champ:"Ekko",winrate:.518524809425253},{champ:"Elise",winrate:.493895050809395},{champ:"Evelynn",winrate:.466038298357659},{champ:"Ezreal",winrate:.485545148641285},{champ:"Fiddlesticks",winrate:.502418998097949},{champ:"Fiora",winrate:.479191438752973},{champ:"Fizz",winrate:.494103383632573},{champ:"Galio",winrate:.508729437829111},{champ:"Gangplank",winrate:.475272864206699},{champ:"Garen",winrate:.510628757226084},{champ:"Gnar",winrate:.457838722847421},{champ:"Gragas",winrate:.51745572103963},{champ:"Graves",winrate:.535110556870696},{champ:"Hecarim",winrate:.474333237808009},{champ:"Heimerdinger",winrate:.488892991183619},{champ:"Illaoi",winrate:.497490816905686},{champ:"Irelia",winrate:.474172674070472},{champ:"Ivern",winrate:.449740514974656},{champ:"Janna",winrate:.512787098902753},{champ:"Jarvan IV",winrate:.520395937114316},{champ:"Jax",winrate:.530931352091651},{champ:"Jayce",winrate:.498398620309682},{champ:"Jhin",winrate:.501583029970556},{champ:"Jinx",winrate:.511073718670017},{champ:"Kai'Sa",winrate:.515817237551695},{champ:"Kalista",winrate:.493511132269794},{champ:"Karma",winrate:.500194212493688},{champ:"Karthus",winrate:.58081893373498},{champ:"Kassadin",winrate:.491815205509883},{champ:"Katarina",winrate:.451131393772105},{champ:"Kayle",winrate:.554085570058389},{champ:"Kayn",winrate:.498578940374468},{champ:"Kennen",winrate:.488442822315693},{champ:"Kha'Zix",winrate:.483186150672351},{champ:"Kindred",winrate:.486685012976446},{champ:"Kled",winrate:.506275883998853},{champ:"Kog'Maw",winrate:.559924612359462},{champ:"LeBlanc",winrate:.466666666690069},{champ:"Lee Sin",winrate:.494543612925522},{champ:"Leona",winrate:.51742954354696},{champ:"Lissandra",winrate:.481136469567536},{champ:"Lucian",winrate:.507134874967248},{champ:"Lulu",winrate:.492258685802578},{champ:"Lux",winrate:.518096616871533},{champ:"Malphite",winrate:.521761874900541},{champ:"Malzahar",winrate:.514912124973638},{champ:"Maokai",winrate:.550234176822921},{champ:"Master Yi",winrate:.492346123107902},{champ:"Miss Fortune",winrate:.501001776741126},{champ:"Mordekaiser",winrate:.501358119023003},{champ:"Morgana",winrate:.530192074286061},{champ:"Nami",winrate:.524283206623903},{champ:"Nasus",winrate:.470759403829525},{champ:"Nautilus",winrate:.519706279039142},{champ:"Nidalee",winrate:.479804934050889},{champ:"Nocturne",winrate:.46126169762374},{champ:"Nunu",winrate:.481377258030678},{champ:"Olaf",winrate:.475846875967083},{champ:"Orianna",winrate:.533438042484914},{champ:"Ornn",winrate:.49563278197677},{champ:"Pantheon",winrate:.485353443319751},{champ:"Poppy",winrate:.533328420893302},{champ:"Pyke",winrate:.46523238627363},{champ:"Quinn",winrate:.460751864813911},{champ:"Rakan",winrate:.506520469793616},{champ:"Rammus",winrate:.493644980662322},{champ:"Rek'Sai",winrate:.466043947643366},{champ:"Renekton",winrate:.494794829541989},{champ:"Rengar",winrate:.487553406525283},{champ:"Riven",winrate:.517079540505592},{champ:"Rumble",winrate:.531666963180751},{champ:"Ryze",winrate:.469362084484097},{champ:"Sejuani",winrate:.474309177586866},{champ:"Shaco",winrate:.462381656801272},{champ:"Shen",winrate:.481795044919493},{champ:"Shyvana",winrate:.477091633495518},{champ:"Singed",winrate:.528018318080683},{champ:"Sion",winrate:.546495489224562},{champ:"Sivir",winrate:.486305836310401},{champ:"Skarner",winrate:.494602889860744},{champ:"Sona",winrate:.527556325861785},{champ:"Soraka",winrate:.4913137893655},{champ:"Swain",winrate:.502147803937758},{champ:"Syndra",winrate:.493487433489452},{champ:"Tahm Kench",winrate:.478827361549577},{champ:"Taliyah",winrate:.527126231000239},{champ:"Talon",winrate:.463339686518301},{champ:"Taric",winrate:.537826877404769},{champ:"Teemo",winrate:.472499738707376},{champ:"Thresh",winrate:.487032466273287},{champ:"Tristana",winrate:.493274416818442},{champ:"Trundle",winrate:.49779207812675},{champ:"Tryndamere",winrate:.505955143070244},{champ:"Twisted Fate",winrate:.488251654343052},{champ:"Twitch",winrate:.500895939060735},{champ:"Udyr",winrate:.493658766539233},{champ:"Urgot",winrate:.51134505318612},{champ:"Varus",winrate:.476136104187942},{champ:"Vayne",winrate:.521392259446102},{champ:"Veigar",winrate:.496676217804412},{champ:"Vel'Koz",winrate:.51679379097404},{champ:"Vi",winrate:.488395615203288},{champ:"Viktor",winrate:.509665541557533},{champ:"Vladimir",winrate:.47935400987539},{champ:"Volibear",winrate:.517387741330441},{champ:"Warwick",winrate:.469156468679203},{champ:"Wukong",winrate:.509678847007245},{champ:"Xayah",winrate:.503280224983727},{champ:"Xerath",winrate:.495114656016152},{champ:"Xin Zhao",winrate:.478278642802619},{champ:"Yasuo",winrate:.513977910969915},{champ:"Yorick",winrate:.495107114525522},{champ:"Zac",winrate:.485367153268848},{champ:"Zed",winrate:.478423817748161},{champ:"Ziggs",winrate:.509211691740744},{champ:"Zilean",winrate:.507737200435052},{champ:"Zoe",winrate:.448825440024095},{champ:"Zyra",winrate:.534561299287912}],xScale_win=d3.scaleLinear().domain([0,1]).range([80,w_dotLine]),sliderValue=parseInt(d3.select(".slider").node().value);sort="win",updateChampion("Nunu"),updateData(),svg.append("line").attr("class","midline").attr("x1",graphicMargin.w_names+graphicMargin.btwn_names+xScale_win(currAvg)).attr("x2",graphicMargin.w_names+graphicMargin.btwn_names+xScale_win(currAvg)).attr("y1",margin.top).attr("y2",margin.top+(graphicMargin.h_col+graphicMargin.h_btwn)*(nPairs-1)+graphicMargin.h_col/2).style("stroke",gray),svg.append("text").text("Paired with...").attr("x",graphicMargin.w_names).attr("y",margin.top-25).attr("class","dataLabel").attr("id","nameDataLabel").call(wrap,50).style("text-anchor","end"),svg.append("text").text("# of games played").attr("x",graphicMargin.w_names+graphicMargin.btwn_names).attr("y",margin.top-25).attr("class","dataLabel").attr("id","nGamesDataLabel").style("text-anchor","start").call(wrap,80),svg.append("text").text(currChampionName+"'s win rate").attr("x",graphicMargin.w_names+graphicMargin.btwn_names+xScale_win(currAvg)).attr("y",margin.top-25).attr("class","dataLabel").attr("id","avgDataLabel").call(wrapChampion),svg.append("text").text("Paired win rate").attr("x",graphicMargin.w_names+graphicMargin.btwn_names+xScale_win(+champ_subset[0].winrate.toFixed(2))).attr("y",margin.top-25).attr("class","dataLabel").attr("id","pairDataLabel").call(wrap,50),pairGroup=svg.selectAll("pairGroup").data(champ_subset).enter().append("g").attr("class","pairGroup").attr("transform","translate(0,"+margin.top+")"),dotGroup=pairGroup.append("g").attr("class","dotGroup"),nameGroup=pairGroup.append("g").attr("class","nameGroup"),dotGroup.append("rect").attr("class","background").attr("id","dotBackground").attr("x",graphicMargin.w_names).attr("y",function(d,i){return(graphicMargin.h_col+graphicMargin.h_btwn)*i}).attr("width",w_dotLine+graphicMargin.btwn_names+margin.right).attr("height",graphicMargin.h_col),dotGroup.append("rect").attr("class","pairBar").attr("width",function(d){return xScale_play(d.n_games)}).attr("height",graphicMargin.h_col).attr("x",graphicMargin.w_names+graphicMargin.btwn_names).attr("y",function(d,i){return(graphicMargin.h_col+graphicMargin.h_btwn)*i}).style("fill",light_gray).style("opacity",.3),nameGroup.append("rect").attr("class","background").attr("id","nameBackground").attr("x",0).attr("y",function(d,i){return(graphicMargin.h_col+graphicMargin.h_btwn)*i}).attr("width",graphicMargin.w_names).attr("height",graphicMargin.h_col),nameGroup.append("text").attr("class","pairNameText").text(function(d){return"+ "+d.champ2}).attr("x",graphicMargin.w_names).attr("y",function(d,i){return(graphicMargin.h_col+graphicMargin.h_btwn)*i+graphicMargin.h_col/2+3}),dotGroup.append("rect").attr("class","dotDistance").attr("x",function(d){var winRate=+d.winrate.toFixed(2);return winRate>currAvg?graphicMargin.w_names+graphicMargin.btwn_names+xScale_win(currAvg):graphicMargin.w_names+graphicMargin.btwn_names+xScale_win(+winRate.toFixed(2))}).attr("y",function(d,i){return(graphicMargin.h_col+graphicMargin.h_btwn)*i+graphicMargin.h_col/2-1}).attr("height",2).attr("width",function(d){return Math.abs(xScale_win(+d.winrate.toFixed(2))-xScale_win(currAvg))}),dotGroup.append("circle").attr("class","avgDot").attr("cx",function(d){return graphicMargin.w_names+graphicMargin.btwn_names+xScale_win(currAvg)}).attr("cy",function(d,i){return(graphicMargin.h_col+graphicMargin.h_btwn)*i+graphicMargin.h_col/2}).attr("r",4).style("fill",highlightColor),dotGroup.append("circle").attr("class","pairDot").attr("cx",function(d){return graphicMargin.w_names+graphicMargin.btwn_names+xScale_win(+d.winrate.toFixed(2))}).attr("cy",function(d,i){return(graphicMargin.h_col+graphicMargin.h_btwn)*i+graphicMargin.h_col/2}).attr("r",4).style("fill",function(d){var roundedWin=+d.winrate.toFixed(2);return roundedWin>currAvg?green:roundedWin<currAvg?red:dark_gray}),dotGroup.append("text").attr("class","countLabel").attr("id","gamesCountLabel").attr("x",graphicMargin.w_names+graphicMargin.btwn_names+5).attr("y",function(d,i){return(graphicMargin.h_col+graphicMargin.h_btwn)*i+graphicMargin.h_col/2+4}).text(function(d){return d3.format(",")(d.n_games)}).style("text-anchor","start").style("fill","none"),dotGroup.append("text").attr("class","countLabel").attr("id","avgCountLabel").attr("x",function(d){return+d.winrate.toFixed(2)>currAvg?graphicMargin.w_names+graphicMargin.btwn_names+xScale_win(currAvg)-8:graphicMargin.w_names+graphicMargin.btwn_names+xScale_win(currAvg)+8}).attr("y",function(d,i){return(graphicMargin.h_col+graphicMargin.h_btwn)*i+graphicMargin.h_col/2+4}).text(function(d){return d3.format(".0%")(currAvg)}).style("text-anchor",function(d){return+d.winrate.toFixed(2)>currAvg?"end":"start"}).style("fill","none"),dotGroup.append("text").attr("class","countLabel").attr("id","pairCountLabel").attr("x",function(d){var roundedWin=+d.winrate.toFixed(2);return roundedWin>currAvg?graphicMargin.w_names+graphicMargin.btwn_names+xScale_win(roundedWin)+8:graphicMargin.w_names+graphicMargin.btwn_names+xScale_win(roundedWin)-8}).attr("y",function(d,i){return(graphicMargin.h_col+graphicMargin.h_btwn)*i+graphicMargin.h_col/2+4}).text(function(d){return d3.format(".0%")(d.winrate)}).style("text-anchor",function(d){return+d.winrate.toFixed(2)>currAvg?"start":"end"}).style("fill","none"),svg.selectAll("breakline").data(champ_subset.filter(function(d,i){return(i+1)%5==0})).enter().append("line").attr("class","breakline").attr("x1",0).attr("x2",w_svg).attr("y1",function(d,i){return margin.top+(graphicMargin.h_col+graphicMargin.h_btwn)*i*5-graphicMargin.h_btwn/2}).attr("y2",function(d,i){return margin.top+(graphicMargin.h_col+graphicMargin.h_btwn)*i*5-graphicMargin.h_btwn/2}),updateClick(),updateSizing(),resize(),window.addEventListener("resize",resize),d3.select("#button-alpha").on("click",function(){sort="alpha",updateButton(d3.select(this)),updateData(),updateGraphic()}),d3.select("#button-win").on("click",function(){sort="win",updateButton(d3.select(this)),updateData(),updateGraphic()}),d3.select("#button-play").on("click",function(){sort="play",updateButton(d3.select(this)),updateData(),updateGraphic()}),d3.select(".slider").on("input",function(){sliderValue=parseInt(d3.select(this).node().value),document.getElementById("slider-instructions").innerHTML="Show pairs with at least "+d3.format(",")(sliderValue)+" games played:",updateData(),updateGraphic()});for(var championNameList=[],i=0;i<avg_data.length;i++)championNameList.push(avg_data[i].champ);!function(inp,arr){function addActive(x){if(!x)return!1;!function(x){for(var i=0;i<x.length;i++)x[i].classList.remove("autocomplete-active")}(x),currentFocus>=x.length&&(currentFocus=0),currentFocus<0&&(currentFocus=x.length-1),x[currentFocus].classList.add("autocomplete-active"),x[currentFocus].style.color="white",x[currentFocus].style.backgroundColor=d3.rgb(79,39,79)}function closeAllLists(elmnt){for(var x=document.getElementsByClassName("autocomplete-items"),i=0;i<x.length;i++)elmnt!=x[i]&&elmnt!=inp&&x[i].parentNode.removeChild(x[i])}var currentFocus;inp.addEventListener("input",function(e){var a,b,i,val=this.value;if(closeAllLists(),!val)return!1;for(currentFocus=-1,(a=document.createElement("DIV")).setAttribute("id",this.id+"autocomplete-list"),a.setAttribute("class","autocomplete-items"),this.parentNode.appendChild(a),i=0;i<arr.length;i++)arr[i].substr(0,val.length).toUpperCase()==val.toUpperCase()&&((b=document.createElement("DIV")).innerHTML="<strong>"+arr[i].substr(0,val.length)+"</strong>",b.innerHTML+=arr[i].substr(val.length),b.innerHTML+='<input type="hidden" value="'+arr[i]+'">',b.addEventListener("click",function(e){inp.value=this.getElementsByTagName("input")[0].value,closeAllLists(),updateChampion("+ "+inp.value),updateData(),updateGraphic(),document.getElementById("searchbar").value=""}),a.appendChild(b))}),inp.addEventListener("keydown",function(e){var x=document.getElementById(this.id+"autocomplete-list");x&&(x=x.getElementsByTagName("div")),40==e.keyCode?(old=currentFocus,currentFocus++,addActive(x),-1<old&&(x[old].style.color=d3.rgb(79,39,79),x[old].style.backgroundColor=d3.color("#fff"))):38==e.keyCode?(old=currentFocus,currentFocus--,addActive(x),-1<old&&(x[old].style.color=d3.rgb(79,39,79),x[old].style.backgroundColor=d3.color("#fff"))):13==e.keyCode&&(e.preventDefault(),-1<currentFocus&&x&&x[currentFocus].click())}),document.addEventListener("click",function(e){closeAllLists(e.target),document.getElementById("searchbar").value=""})}(document.getElementById("searchbar"),championNameList)}function rowConverter(d){return{champ1:d.champ1,champ2:d.champ2,winrate:parseFloat(d.winrate),n_games:parseInt(d.n_games)}}d3.csv("jungler_pair_long.csv",rowConverter,function(data){dataset=data,init()});
